  # Kiosk24

  Kiosk24 is a small Next.js dashboard for browsing and comparing website screenshots stored in Supabase.

  It’s designed for a “kiosk” workflow where screenshots are captured regularly by an external job, and this app is used to:
  - pick a day + device (desktop/mobile)
  - filter to one or more URLs (optionally by language)
  - review the captured screenshots
  - visually compare two screenshots with a drag slider

  ## Routes

  - `/` (Home): select a date, device, URLs, and languages; then view screenshots grouped by URL.
  - `/compare` (Compare): pick two screenshots (each can be a different URL/date) and compare them with a slider.

  ## Tech stack

  - Next.js (App Router)
  - React + TypeScript
  - Tailwind CSS + Radix UI primitives
  - TanStack React Query for client-side data fetching/caching
  - Supabase (Postgres + RPC) as the data source

  ## Environment variables

  Create a `.env.local` with:

  ```bash
  NEXT_PUBLIC_SUPABASE_URL="https://YOUR_PROJECT.supabase.co"
  NEXT_PUBLIC_SUPABASE_PUBLISHABLE_KEY="YOUR_SUPABASE_ANON_OR_PUBLISHABLE_KEY"
  ```

  Notes:
  - The app uses `@supabase/ssr` for both server and browser clients.
  - Keys are read via `NEXT_PUBLIC_*` variables (so they are exposed to the browser). Use a Supabase key appropriate for public clients.

  ## Database (Supabase)

  ### Table: `public.screenshots`

  The UI expects screenshot records with:
  - `url` (text)
  - `device` (text; the UI uses `desktop` or `mobile`)
  - `captured_at` (timestamp with time zone)
  - `screenshot_url` (text, nullable; used for display)
  - `job_status` (text/enum; the UI expects values `ok` or `failed`)

  Example schema:

  ```sql
  create table public.screenshots (
    id bigint generated by default as identity primary key,
    url text not null,
    public_id text not null,
    screenshot_url text null,
    job_status text not null,
    captured_at timestamp with time zone not null,
    device text not null
  );
  ```

  If you use an enum type (recommended), make sure it includes `ok` and `failed` because the app filters/branches on those values.

  ### Required RPC functions

  The app calls two Supabase RPC functions:

  1) `get_unique_urls_with_lang`
  - Returns: rows shaped like `{ url: string, language: string }`
  - Used to populate the URL list and language filter.

  2) `get_screenshot_days`
  - Returns: an array of day strings in `YYYY-MM-DD` format (or any ISO date string that the app can parse).
  - Used to enable only dates that have screenshots.

  Implementations depend on your schema. If you don’t have language stored separately, you can return a default or derive it from the URL.

  ## Development

  ```bash
  npm install
  npm run dev
  ```

  Then open `http://localhost:3000`.

  ## Scripts

  - `npm run dev` – start dev server
  - `npm run build` – production build
  - `npm run start` – run production server
  - `npm run lint` – Biome checks
  - `npm run format` – format with Biome
  - `npm run typecheck` – TypeScript typecheck