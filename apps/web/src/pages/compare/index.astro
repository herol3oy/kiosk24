---
import Layout from "../../layouts/Layout.astro";
import ComparePanelWrapper from "../../components/ComparePanel";

const baseUrl = "/api";
const cdn = process.env.PUBLIC_CDN_URL || "http://localhost:8787";

const l_url = Astro.url.searchParams.get("l_url");
const l_date = Astro.url.searchParams.get("l_date");
const l_hour = Astro.url.searchParams.get("l_hour");
const r_url = Astro.url.searchParams.get("r_url");
const r_date = Astro.url.searchParams.get("r_date");
const r_hour = Astro.url.searchParams.get("r_hour");
const r_device = Astro.url.searchParams.get("r_device");
const l_device = Astro.url.searchParams.get("l_device");    
---

<Layout title="Compare Screenshots">
    <div class="max-w-400 mx-auto p-4 md:p-6 space-y-6">
        <header
            class="flex flex-col md:flex-row md:items-center justify-between gap-4 mb-4"
        >
            <div>
                <h1 class="text-2xl font-bold text-gray-800">
                    Visual Comparison
                </h1>
            </div>
            {
                (l_url || r_url) && (
                    <a
                        href={Astro.url.pathname}
                        class="text-xs font-medium text-red-600 hover:text-red-800 bg-red-50 hover:bg-red-100 px-3 py-1.5 rounded-md transition-colors"
                    >
                        Reset All Filters
                    </a>
                )
            }
        </header>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <ComparePanelWrapper
                client:load
                side="left"
                baseUrl={baseUrl}
                cdn={cdn}
                url={l_url}
                date={l_date}
                hour={l_hour}
                device={l_device}
            />
            <ComparePanelWrapper
                client:load
                side="right"
                baseUrl={baseUrl}
                cdn={cdn}
                url={r_url}
                date={r_date}
                hour={r_hour}
                device={r_device}
            />
        </div>
    </div>
</Layout>
